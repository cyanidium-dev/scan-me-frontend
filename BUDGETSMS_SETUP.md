# Налаштування BudgetSMS для відправки SMS

## Що було реалізовано

1. **API Route** (`src/app/api/sms/route.ts`):
   - Ендпоінт для відправки SMS через BudgetSMS
   - Підтримка відправки на кілька номерів одночасно
   - Обробка помилок та логування

2. **Автоматична відправка SMS** (`src/components/emergencyInfoPage/EmergencyInfoPage.tsx`):
   - При відкритті сторінки `/emergency-info/[qrId]` автоматично відправляються SMS на всі номери екстрених контактів
   - Повідомлення містить QR-ID та ПІБ власника

## Що потрібно від вас для налаштування

### 1. Отримати облікові дані BudgetSMS

Зайдіть на https://www.budgetsms.net/ та:
- Зареєструйтеся або увійдіть у свій акаунт
- Отримайте наступні дані з вашого профілю:
  - **Username** (ім'я користувача)
  - **UserID** (ID користувача)
  - **Handle** (токен/ключ API)

### 2. Додати змінні оточення

Додайте наступні змінні у ваш файл `.env.local` (або `.env`):

```env
# BudgetSMS API Credentials
BUDGETSMS_USERNAME=ваш_username
BUDGETSMS_USERID=ваш_userid
BUDGETSMS_HANDLE=ваш_handle
BUDGETSMS_API_URL=https://api.budgetsms.net/sendsms
```

**Важливо:** 
- Не комітьте файл `.env.local` у git (він має бути в `.gitignore`)
- Для production додайте ці змінні у налаштування вашого хостингу (Vercel, Netlify тощо)

### 3. Формат повідомлення

За замовчуванням повідомлення має формат:
```
QrCode ScanMe номер {qrId}. {ПІБ} було відскановано. Ймовірно трапилась екстренна ситуація.
```

Приклад:
```
QrCode ScanMe номер SM-A1C9-92. Андрій Ковальчук було відскановано. Ймовірно трапилась екстренна ситуація.
```

### 4. Тестування

1. Переконайтеся, що у профілі користувача є екстрені контакти з номерами телефонів
2. Відкрийте сторінку `/emergency-info/{qrId}` 
3. Перевірте консоль браузера та серверні логи на наявність помилок
4. Перевірте, чи прийшли SMS на вказані номери

### 5. Обробка помилок

- Якщо SMS не відправляються, перевірте:
  - Чи правильно налаштовані змінні оточення
  - Чи достатньо коштів на рахунку BudgetSMS
  - Чи правильно відформатовані номери телефонів
  - Перевірте логи сервера для деталей помилок

### 6. Документація BudgetSMS

Детальна документація API: https://www.budgetsms.net/
- HTTP API документація
- Формат запитів
- Коди помилок
- Обмеження та ліміти

## Примітки

- SMS відправляються автоматично при кожному відкритті сторінки emergency-info
- Якщо потрібно обмежити кількість відправок (наприклад, один раз на день), це можна додати через Firebase або іншу систему логування
- Номери телефонів автоматично форматуются (прибираються всі символи крім цифр)
